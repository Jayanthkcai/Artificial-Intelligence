A semantic configuration within your index defines field inputs for semantic ranking. It's flexible, allowing you to add or modify configurations without needing to rebuild. Multiple configurations can be created, with the option to set a default. During query execution, you can specify a semantic configuration or utilize the default if left blank.
- Title field:	A short string, ideally under 25 words. This field could be the title of a document, name of a product, or a unique identifier. If you don't have suitable field, leave it blank.
- Content fields:	Longer chunks of text in natural language form, subject to maximum token input limits on the machine learning models. Common examples include the body of a document, description of a product, or other free-form text.
- Keyword fields:	A list of keywords, such as the tags on a document, or a descriptive term, such as the category of an item.

Limited to one title field, but we can include multiple content and keyword fields. Prioritize content and keyword fields since lower priority ones might be truncated. Ensure that all assigned fields are marked as searchable and retrievable, and are of type Edm.String or compatible string subfields.

Semantic ranking in Azure AI Search enhances search result rankings by leveraging language comprehension to better match the context of the initial query. BM25 ranking function is used by default, it ranks search results based on the frequency that the search term appears within a document. BM25 ranking doesn't place any relevance on the semantics of the query and ranking can sometimes be improved by adding language understanding.

Semantic ranking in Azure AI Search does two things: it makes search results better by understanding language, and it enhances the responses by adding captions and answers.

It works by using the BM25 ranking method and then adjusting it based on language understanding models to better understand the context and meaning of the search query.

Semantic captions and answers offer supplementary information alongside the ranked search outcomes, aiding user comprehension.

Semantic captions extract concise summaries directly from the document and emphasize the most pertinent text within these summaries.

Semantic answers, an optional feature of semantic ranking, furnishes responses to queries. If a search query resembles a question and the results contain potentially relevant answers, semantic answers are included.

Semantic ranking in Azure AI Search initially selects the top 50 results from the BM25 ranking outcomes, splitting them into multiple fields as specified by a semantic configuration. These fields are converted into text strings and limited to 256 unique tokens, with each token roughly representing a word in the document.

Subsequently, these strings undergo machine reading comprehension analysis to identify phrases and sentences that closely match the query. The outcome of this summarization process yields semantic captions and, optionally, semantic answers.

The semantic captions are then prioritized based on their semantic relevance, and the results are returned in descending order of relevance.

Semantic ranking offers two main advantages over traditional search results:

1. It can better align search results with the semantics of the original query, increasing the likelihood of the most relevant documents appearing at the top of the results.

2. Semantic ranking can identify strings within the results to display as captions on the search results page and to offer answers to questions, enhancing user understanding and interaction with the search results.

**Limitations** 
- Semantic ranking is utilized on outcomes produced by the BM25 ranking function. While semantic ranking can reorder the results generated by the BM25 ranking function, it doesn't introduce any new documents beyond what was already returned.

- Semantic ranking processes the top 50 results from the BM25 ranking function. If there are more than 50 results, only the top 50 are taken into account.











## Migrating from previous version
As of July 14, 2023, the semantic ranker doesn't favor any particular language, so it can reorder search results that include content in multiple languages. In the past, it would prioritize results in the language specified by the field analyzer.

In API versions from 2021-04-30-Preview onwards, we define which search fields contribute to semantic ranking using semanticConfiguration within an index definition. The older method of specifying and prioritizing fields using searchFields in a query request, which was only applicable to the 2020-06-30-Preview REST API, is no longer used in newer versions.

- The semantic ranking engine is now language agnostic. If queryLanguage is specified in your query logic, it's no longer used for semantic ranking, but still applies to spell correction. Keep queryLanguage if you're using speller, and if the language value is supported by speller. Spell check has limited availability across languages. Otherwise, delete queryLanguage.
- If you're using older versions of the REST API or beta SDKs, you might be using searchFields in query requests to prioritize semantic fields. However, in newer versions, searchFields is only for limiting full text search. Keep searchFields in query requests if you're using it to limit full text search to the list of named fields.For semantic ranking, you should add a semanticConfiguration to your index schema as explained here.

## Semantic Configuration
Semantic configurations describe the title, content, and keywords fields that will be used for semantic ranking, captions, highlights, and answers

```json
  "semantic": {
    "defaultConfiguration": null,
    "configurations": [
      {
        "name": "semantic100001",
        "prioritizedFields": {
          "titleField": {
            "fieldName": "metadata_title"
          },
          "prioritizedContentFields": [
            {
              "fieldName": "merged_content"
            }
          ],
          "prioritizedKeywordsFields": [
            {
              "fieldName": "keyphrases"
            }
          ]
        }
      }
    ]
  }
```
- "answers": This parameter specifies how the search engine should generate answers or summaries from the search results. In this case, the value "extractive|count-3" indicates that the search engine should extract answers from the search results using an extractive method, and it should provide up to 3 answers.

- "captions": This parameter specifies whether the search engine should include captions or highlights in the search results. The value "extractive|highlight-true" indicates that the search engine should generate highlights for the search results to emphasize the relevance of the matched terms.

These parameters help enhance the search experience by providing concise answers or summaries from the search results and by highlighting the relevant terms in the search results to the user.

there can be various values for the "answers" and "captions" parameters depending on the specific requirements of the search application. Here are some possible values:

**For "answers":**

- "extractive|count-5": Extract up to 5 answers from the search results using an extractive method.
- "abstractive|count-3": Generate up to 3 abstractive summaries from the search results using an abstractive method.
- "mixed|count-5": Provide a mix of both extractive and abstractive answers, with up to 5 answers in total.

**For "captions":**

- "highlight-true": Include highlights in the search results to indicate where the matched terms are found.
- "snippet-true": Generate snippets of text from the search results to provide context around the matched terms.
- "summary-true": Include a summary of the search results to provide an overview of the content.

These are just examples, and the actual values may vary depending on the capabilities of the search engine and the requirements of the search application.

**Request**
```json
{
     "queryType": "semantic",
     "search": "historic hotel with good food",
     "semanticConfiguration": "semantic100001",
     "answers": "extractive|count-2",
     "captions": "extractive|highlight-true",
     "count": true
 }
```

**Response**
The "@search.captions" field contains an array of objects, each representing a caption related to the search query. Each caption object contains two properties:

- "text": This property captures the actual text content relevant to the search query.
- "highlights": This property captures the highlighted portions of the text that match the search query, typically formatted to distinguish them from the surrounding text, such as with HTML tags like "<em>".

In the provided example, the "text" property contains the full text content, while the "highlights" property contains the text with emphasized portions that match the search query.

```json
{
  "@odata.context": "https://aidemosearch100001.search.windows.net/indexes('azureblob-index')/$metadata#docs(*)",
  "@odata.count": 72,
  "@search.answers": [],
  "@search.nextPageParameters": {
    "search": "historic hotel with good food",
    "answers": "extractive|count-3",
    "captions": "extractive|highlight-true",
    "semanticConfiguration": "semantic100001",
    "count": true,
    "queryType": "semantic",
    "skip": 50
  },
  "value": [
    {
      "@search.score": 3.2735236,
      "@search.rerankerScore": 2.162339210510254,
      "@search.captions": [
        {
          "text": "Food is fantastic, buffet restaurant Saffron is the   best hotel buffet i have ever ate in. The steakhouse is well worth the splurge! Staff at the hotel cant   seem to do enough for you, and rooms were spotless. And to have a fantastic waterpark, free of   charge on your doorstep is brilliant!",
          "highlights": "Food is fantastic, buffet restaurant Saffron is the<em>   best hotel</em> buffet i have ever ate in. The steakhouse is well worth the splurge! Staff at the<em> hotel</em> cant   seem to do enough for you, and rooms were spotless. And to have a fantastic waterpark, free of   charge on your doorstep is brilliant!"
        }
      ],
      "content": "\nFANTASTIC! WHAT A PLACE. \n\nThe Lost City Hotel, Dubai, UAE \n\n11/20/2018 \n\nWell firstly can I just say, to anyone who is wanting to stay at The Lost City and is reading reviews on \n\nTrip Advisor: TAKE NO NOTICE OF PEOPLE WHO DON'T RATE THIS HOTEL. My god, you would have to \n\nbe seriously spoiled to say this hotel is not a 5 star! I have travelled all over the world and stayed in \n\nmany 5 star hotels and this is the best hotel I have ever stayed in. Yes the alcohol is expensive (Dubai \n\nin general is like that) and I will admit that £6 for a bottle of beer is expensive, but the surroundings \n\nyour drinking it in seem to take the pain away!!!. ( Little tip for you, buy a couple of bottle of wine at \n\nyour outbound airport to keep in your hotel room). Food is fantastic, buffet restaurant Saffron is the \n\nbest hotel buffet i have ever ate in. The steakhouse is well worth the splurge! Staff at the hotel cant \n\nseem to do enough for you, and rooms were spotless. And to have a fantastic waterpark, free of \n\ncharge on your doorstep is brilliant! All in all I had a fantastic holiday and would go back tomorrow if \n\nI could! One more thing, sitting out on the beach at night at Restaurant is brill! Great atmosphere \n\nand great music.Yes its expensive, but in this money orientated world, you get what you pay \n\nfor.!!!!!!!! \n\nReviewer: Bogdan Stoyanov \n\n\n",
      "metadata_storage_last_modified": "2024-04-06T11:38:48Z",
      "metadata_storage_path": "aHR0cHM6Ly9zdG9yZTIwMDAwMS5ibG9iLmNvcmUud2luZG93cy5uZXQvc2VhcmNoLzIwMTg1MS5wZGY1",
      "metadata_content_type": "application/pdf",
      "metadata_language": "en",
      "metadata_author": "Reviewer",
      "metadata_title": "Review",
      "locations": [
        "Lost City Hotel",
        "UAE",
        "The Lost City",
        "HOTEL",
        "hotel",
        "world",
        "hotels",
        "Dubai",
        "in",
        "hotel room",
        "buffet restaurant",
        "steakhouse",
        "rooms",
        "waterpark",
        "doorstep",
        "beach",
        "Restaurant"
      ],
      "language": "en",
      "keyphrases": [
        "The Lost City Hotel",
        "many 5 star hotels",
        "money orientated world",
        "best hotel buffet",
        "Trip Advisor",
        "Little tip",
        "outbound airport",
        "hotel room",
        "buffet restaurant",
        "fantastic waterpark",
        "fantastic holiday",
        "Great atmosphere",
        "great music",
        "Bogdan Stoyanov",
        "PLACE",
        "Dubai",
        "UAE",
        "reviews",
        "NOTICE",
        "PEOPLE",
        "god",
        "alcohol",
        "bottle",
        "beer",
        "surroundings",
        "pain",
        "wine",
        "Food",
        "Saffron",
        "steakhouse",
        "splurge",
        "Staff",
        "rooms",
        "charge",
        "doorstep",
        "thing",
        "beach",
        "night",
        "Reviewer"
      ],
      "merged_content": "\nFANTASTIC! WHAT A PLACE. \n\nThe Lost City Hotel, Dubai, UAE \n\n11/20/2018 \n\nWell firstly can I just say, to anyone who is wanting to stay at The Lost City and is reading reviews on \n\nTrip Advisor: TAKE NO NOTICE OF PEOPLE WHO DON'T RATE THIS HOTEL. My god, you would have to \n\nbe seriously spoiled to say this hotel is not a 5 star! I have travelled all over the world and stayed in \n\nmany 5 star hotels and this is the best hotel I have ever stayed in. Yes the alcohol is expensive (Dubai \n\nin general is like that) and I will admit that £6 for a bottle of beer is expensive, but the surroundings \n\nyour drinking it in seem to take the pain away!!!. ( Little tip for you, buy a couple of bottle of wine at \n\nyour outbound airport to keep in your hotel room). Food is fantastic, buffet restaurant Saffron is the \n\nbest hotel buffet i have ever ate in. The steakhouse is well worth the splurge! Staff at the hotel cant \n\nseem to do enough for you, and rooms were spotless. And to have a fantastic waterpark, free of \n\ncharge on your doorstep is brilliant! All in all I had a fantastic holiday and would go back tomorrow if \n\nI could! One more thing, sitting out on the beach at night at Restaurant is brill! Great atmosphere \n\nand great music.Yes its expensive, but in this money orientated world, you get what you pay \n\nfor.!!!!!!!! \n\nReviewer: Bogdan Stoyanov \n\n\n",
      "text": [],
      "layoutText": [],
      "imageTags": [],
      "imageCaption": []
    },
    {
      "@search.score": 6.3449492,
      "@search.rerankerScore": 2.1481692790985107,
      "@search.captions": [
        {
          "text": "It is steps from fisherman's   wharf San Francisco where there is nightlife, shopping, great food, entertainment, and scenery. It is   very centrally located. I have stayed at this hotel many times. I am from San Francisco and I always   stay here. It has parking, fitness center, continental breakfast, and great service.",
          "highlights": ""
        }
      ],
      "content": "\nlocation location location \n\nThe Wharf Hotel, San Francisco, USA \n\n10/30/2018 \n\nThis hotel is wonderful to stay if you want to wake up and see the city. It is steps from fisherman's \n\nwharf San Francisco where there is nightlife, shopping, great food, entertainment, and scenery. It is \n\nvery centrally located. I have stayed at this hotel many times. I am from San Francisco and I always \n\nstay here. It has parking, fitness center, continental breakfast, and great service. I highly recommend \n\nthis hotel to everyone due to it 's economical prices. Whenever I am in town for business or pleasure \n\nI stay here. \n\nReviewer: Ernest Vandiver \n\n\n",
      "metadata_storage_last_modified": "2024-04-06T11:38:45Z",
      "metadata_storage_path": "aHR0cHM6Ly9zdG9yZTIwMDAwMS5ibG9iLmNvcmUud2luZG93cy5uZXQvc2VhcmNoLzIwMTgzNi5wZGY1",
      "metadata_content_type": "application/pdf",
      "metadata_language": "en",
      "metadata_author": "Reviewer",
      "metadata_title": "Review",
      "locations": [
        "Wharf Hotel",
        "San Francisco",
        "USA",
        "hotel",
        "city",
        "fisherman's",
        "wharf",
        "parking",
        "fitness center",
        "town"
      ],
      "language": "en",
      "keyphrases": [
        "location location location",
        "wharf San Francisco",
        "The Wharf Hotel",
        "great food",
        "fitness center",
        "continental breakfast",
        "great service",
        "economical prices",
        "Ernest Vandiver",
        "USA",
        "city",
        "steps",
        "fisherman",
        "nightlife",
        "shopping",
        "entertainment",
        "scenery",
        "parking",
        "everyone",
        "town",
        "business",
        "pleasure",
        "Reviewer"
      ],
      "merged_content": "\nlocation location location \n\nThe Wharf Hotel, San Francisco, USA \n\n10/30/2018 \n\nThis hotel is wonderful to stay if you want to wake up and see the city. It is steps from fisherman's \n\nwharf San Francisco where there is nightlife, shopping, great food, entertainment, and scenery. It is \n\nvery centrally located. I have stayed at this hotel many times. I am from San Francisco and I always \n\nstay here. It has parking, fitness center, continental breakfast, and great service. I highly recommend \n\nthis hotel to everyone due to it 's economical prices. Whenever I am in town for business or pleasure \n\nI stay here. \n\nReviewer: Ernest Vandiver \n\n\n",
      "text": [],
      "layoutText": [],
      "imageTags": [],
      "imageCaption": []
    },
    {
      "@search.score": 4.359699,
      "@search.rerankerScore": 2.1439566612243652,
      "@search.captions": [
        {
          "text": "Great New York Boutique Hotel in quiet Neighbourhood   The Grand Central Hotel, New York, USA   11/8/2018   This is a lovely hotel in a great area of Manhattan. We were able to walk everywhere and we did just   that. Grand Central Station is only mins away as are various bars restaurants etc...",
          "highlights": "<em>Great</em> New York Boutique<em> Hotel</em> in quiet Neighbourhood   The Grand Central<em> Hotel,</em> New York, USA   11/8/2018   This is a lovely<em> hotel</em> in a<em> great</em> area of Manhattan. We were able to walk everywhere and we did just   that. Grand Central Station is only mins away as are various bars restaurants etc..."
        }
      ],
      "content": "\nGreat New York Boutique Hotel in quiet Neighbourhood \n\nThe Grand Central Hotel, New York, USA \n\n11/8/2018 \n\nThis is a lovely hotel in a great area of Manhattan. We were able to walk everywhere and we did just \n\nthat. Grand Central Station is only mins away as are various bars restaurants etc... Thoroughly \n\nrecommend Madison avenue for good value burgers and the like.... The room size is good the bed is \n\nabsolutely fabulously comfy and it was a lovely surprise for my husband to receive a bottle of bubbly \n\nand a small birthday cake shortly after checking in. Thank you very much !! The rooms were kept \n\nlovely and clean and we had a glass of wine each evening on the house between 5 and 6 another \n\nlovely touch. Would thoroughly recommend this hotel and next time we visit New York it will \n\ndefinitely be to this hotel. \n\nReviewer: Eunice Vinson \n\n\n",
      "metadata_storage_last_modified": "2024-04-06T11:38:45Z",
      "metadata_storage_path": "aHR0cHM6Ly9zdG9yZTIwMDAwMS5ibG9iLmNvcmUud2luZG93cy5uZXQvc2VhcmNoLzIwMTgzOC5wZGY1",
      "metadata_content_type": "application/pdf",
      "metadata_language": "en",
      "metadata_author": "Reviewer",
      "metadata_title": "Review",
      "locations": [
        "Great New York",
        "Hotel",
        "Neighbourhood",
        "Grand Central Hotel",
        "New York",
        "USA",
        "hotel",
        "Manhattan",
        "Grand Central Station",
        "bars",
        "restaurants",
        "room",
        "rooms",
        "house"
      ],
      "language": "en",
      "keyphrases": [
        "Great New York Boutique Hotel",
        "The Grand Central Hotel",
        "Grand Central Station",
        "various bars restaurants",
        "good value burgers",
        "small birthday cake",
        "great area",
        "lovely hotel",
        "quiet Neighbourhood",
        "Madison avenue",
        "room size",
        "lovely surprise",
        "lovely touch",
        "Eunice Vinson",
        "USA",
        "Manhattan",
        "bed",
        "husband",
        "bottle",
        "bubbly",
        "rooms",
        "glass",
        "wine",
        "house",
        "Reviewer"
      ],
      "merged_content": "\nGreat New York Boutique Hotel in quiet Neighbourhood \n\nThe Grand Central Hotel, New York, USA \n\n11/8/2018 \n\nThis is a lovely hotel in a great area of Manhattan. We were able to walk everywhere and we did just \n\nthat. Grand Central Station is only mins away as are various bars restaurants etc... Thoroughly \n\nrecommend Madison avenue for good value burgers and the like.... The room size is good the bed is \n\nabsolutely fabulously comfy and it was a lovely surprise for my husband to receive a bottle of bubbly \n\nand a small birthday cake shortly after checking in. Thank you very much !! The rooms were kept \n\nlovely and clean and we had a glass of wine each evening on the house between 5 and 6 another \n\nlovely touch. Would thoroughly recommend this hotel and next time we visit New York it will \n\ndefinitely be to this hotel. \n\nReviewer: Eunice Vinson \n\n\n",
      "text": [],
      "layoutText": [],
      "imageTags": [],
      "imageCaption": []
    },
    {
      "@search.score": 8.459027,
      "@search.rerankerScore": 2.1434781551361084,
      "@search.captions": [
        {
          "text": "City Centre Shopping Mall\r The French restaurant\r The Deira Hotel\r good value\r good toiletries\r Hotel room\r Five minutes\r old area\r gold/spice souks\r Gangaadhar Sridhara\r Dubai\r UAE\r money\r rooms\r bathroom\r staff\r time\r taxi\r people\r chain\r hotels\r care\r guests\r Reviewer. Very good value.",
          "highlights": "<em>City Centre Shopping Mall\r</em> The French restaurant\r The Deira Hotel\r good value\r good toiletries\r Hotel room\r Five minutes\r old area\r gold/spice souks\r Gangaadhar Sridhara\r Dubai\r UAE\r money\r rooms\r bathroom\r staff\r time\r taxi\r people\r chain\r hotels\r care\r guests\r Reviewer. Very good value."
        }
      ],
      "content": "\nVery good value. \n\nThe Deira Hotel, Dubai, UAE \n\n5/2/2018 \n\nthis hotel is very good for the money. The rooms are exceptionally large with good toiletries in the \n\nbathroom. Hotel room was spotless, staff were exceptionally helpful and polite.The French \n\nrestaurant looked good although unfortunately I did not have time to try it out, but highly spoken \n\nabout. I would not hesitate to stay here again. Five minutes in a taxi to City Centre Shopping Mall or \n\nthe old area of Deira with gold/spice souks. The people who own this chain of hotels really seem to \n\ncare about their guests. \n\nReviewer: Gangaadhar Sridhara \n\n\n",
      "metadata_storage_last_modified": "2024-04-06T11:38:41Z",
      "metadata_storage_path": "aHR0cHM6Ly9zdG9yZTIwMDAwMS5ibG9iLmNvcmUud2luZG93cy5uZXQvc2VhcmNoLzIwMTgwNi5wZGY1",
      "metadata_content_type": "application/pdf",
      "metadata_language": "en",
      "metadata_author": "Reviewer",
      "metadata_title": "Review",
      "locations": [
        "Deira Hotel",
        "Dubai",
        "UAE",
        "hotel",
        "rooms",
        "Hotel room",
        "French",
        "restaurant",
        "City Centre Shopping Mall",
        "Deira",
        "hotels"
      ],
      "language": "en",
      "keyphrases": [
        "City Centre Shopping Mall",
        "The French restaurant",
        "The Deira Hotel",
        "good value",
        "good toiletries",
        "Hotel room",
        "Five minutes",
        "old area",
        "gold/spice souks",
        "Gangaadhar Sridhara",
        "Dubai",
        "UAE",
        "money",
        "rooms",
        "bathroom",
        "staff",
        "time",
        "taxi",
        "people",
        "chain",
        "hotels",
        "care",
        "guests",
        "Reviewer"
      ],
      "merged_content": "\nVery good value. \n\nThe Deira Hotel, Dubai, UAE \n\n5/2/2018 \n\nthis hotel is very good for the money. The rooms are exceptionally large with good toiletries in the \n\nbathroom. Hotel room was spotless, staff were exceptionally helpful and polite.The French \n\nrestaurant looked good although unfortunately I did not have time to try it out, but highly spoken \n\nabout. I would not hesitate to stay here again. Five minutes in a taxi to City Centre Shopping Mall or \n\nthe old area of Deira with gold/spice souks. The people who own this chain of hotels really seem to \n\ncare about their guests. \n\nReviewer: Gangaadhar Sridhara \n\n\n",
      "text": [],
      "layoutText": [],
      "imageTags": [],
      "imageCaption": []
    }
}

```

**Example**
**{
  "name": "semanticConfig1",
  "fields": [
    {
      "name": "title",
      "type": "string",
      "weight": 10
    },
    {
      "name": "description",
      "type": "string",
      "weight": 5
    },
    {
      "name": "tags",
      "type": "collection(string)",
      "weight": 3
    }
  ]
}
**

- The "name" attribute specifies the name of the semantic configuration.
- Each "fields" entry represents a field in the index that contributes to semantic ranking.
- For each field, "name" identifies the field name, "type" specifies the field type, and "weight" assigns a weight to the field, indicating its importance in ranking. A higher weight means the field has more influence on relevance.
Explanation:

- The "title" field, with a weight of 10, is considered the most significant for semantic ranking, likely containing key information about the indexed documents.
- The "description" field, with a weight of 5, is also important but less so than the title.
- The "tags" field, with a weight of 3, contributes to semantic ranking but to a lesser extent than the title and description.

This semantic configuration guides the search engine on how to weigh and prioritize fields when calculating relevance scores for search results, ultimately improving the quality of search outcomes.